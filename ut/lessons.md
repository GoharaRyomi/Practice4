# ユニットテスト課題 <!-- omit in toc -->

## 勉強内容 <!-- omit in toc -->

- なぜテストコードが必要なのか
- 基本の「き」
- 今までの総復習

## 目次 <!-- omit in toc -->

- [なぜテストコードが必要なのか](#なぜテストコードが必要なのか)
- [基本の「き」](#基本のき)
- [課題 1](#課題-1)
  - [課題 1 確認事項](#課題-1-確認事項)
- [課題 2](#課題-2)
  - [課題 2 確認事項](#課題-2-確認事項)
- [課題 3](#課題-3)
  - [課題 3 確認事項](#課題-3-確認事項)

## なぜテストコードが必要なのか

テストコードを実装することで予期しない変更や変更漏れが防げる。またテスト対象のコードが保証されることでそのコードを使用する側のテストがシンプルになる。

- メリット
  - メソッドの品質が保証されることで再使用しやすくなる
    - 後からプロジェクトに参画した人もそのコードを使用しやすくなる
  - 同じ条件のテストを簡単に何回でも実行できるようになる
  - テストしやすいような実装をすることで実装がよりシンプルになる（副作用的）
  - 結合テストなど後ろのフェーズからの後戻りが減る
  - 新しい機能を実装したときに既存のコードの処理が保証される
  - 新しい機能を実装したときに影響が出る箇所を見落とさなくなる
- デメリット
  - 実装工数が増える
  - テストの内容によってはコードが読みづらくなる

## 基本の「き」

- 機能を実装するクラスに対してはインターフェースを実装する
  - publicメソッドとprivateメソッドを使い分けることで、呼び出し側に公開してもよいものか考えて実装する
  - 呼び出し側がモックできるようになる（ポリモーフィズムの恩恵）
- 1メソッド1機能を基本として実装する
  - 〇：DBへ書き込みをする
  - ×：DBへ書き込み後、外部サービスを呼び出してモデルを作成する
    - 実装するクラスがユースケースやコントローラーなどのハンドリングを行うクラスの場合はその限りではない
- メソッド名、引数、返却値に嘘を書かない
  - 〇：toString(int val): String　引数にもらった数値をString型に変換して返す
  - ×：toString(int val): Long　引数にもらった数値をLong型に変換して返す
  - between(int target, int from, int to): boolean
    - 〇：第一引数の数値が第二引数と第三引数の間にあるかどうかを返す
    - ×：第三引数の数値が第一引数と第二引数の間にあるかどうかを返す
- テストがパスしているかどうかはアサーションで確認する
  - メソッドの引数が偶数の場合「hoge」と返してくることを確認
- ネストさせてグルーピングする
  - クラス「Hoge」のメソッド「foo」の「正常系」と「異常系」
- テストケースは仕様書から拾う

## 課題 1

自分の名前をパッケージ名として新しくパッケージを作成し、Lesson01をクラス名してとして以下の機能を持つクラスを作成してください。

- 数値型の値の保持
- 現在保持している値を取得
- 現在保持している値に別の値を加算
- 現在保持している値から別の値を減算
- 現在保持している値に別の値を乗算
- 現在保持している値から別の値を除算

### 課題 1 確認事項

- カプセル化の概念が実装されているかどうか
  - 用意されたメソッド以外に値を変更することが可能なのかどうか
- 機能ごとにメソッドを実装、テストコードがかけるかどうか

## 課題 2

[課題 1](#課題-1)で作成したパッケージ内に以下のクラス等を作成してください。

- Character: abstract class
  - hp: int
  - atk: int
  - def: int
- PlayableCharacter: interface
  - attack(Character target): void /** 引数のCharacterのhpから(自身のatk - 対象のdef)という計算結果を引く */
- Player: extends Character implements PlayableCharacter
- Enemy: extends Character

### 課題 2 確認事項

- 継承が実装できるかどうか
- テストコード内でポリモーフィズムできるか

## 課題 3

[課題 1](#課題-1)で作成したパッケージ内にLesson03をクラス名として以下機能を持つクラスを作成してください。

- アプリ起動時の処理
  - プロセスID（PID）を `pid` というファイル名のファイルに出力する
    - 既に存在する場合は新規作成で上書き
  - [課題 2](#課題-2)で作成したクラス `Player` および `Enemy` をインスタンス化する
- 起動するとコンソールからの入力待ちを行う
  - 0を入力するとアプリが終了する
  - 1を入力すると所定の処理を実施後再度入力待ちを行う
- 所定の処理
  - Player.attach(enemy)を呼び出す
  - enemyのhpが0以下の場合、「Victory!」とコンソール出力してアプリを終了する

### 課題 3 確認事項

- ファイル出力したあとにファイルをクローズできているか
- 入力の分岐が正しいかどうか
- 無限ループの終了条件が正しいかどうか
